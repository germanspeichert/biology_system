function y = signal_mode (t,k)
	u = rand;
	extrasistol_weight = 0.2;

	if (u<=(1-extrasistol_weight)) 
		y = (1/0.05*(t-k)-0.4/0.05).*(0.40+k<t & t<=0.45+k)+(-2/0.1*(t-k)+0.5/0.05).*(0.45+k<t & t<=0.55+k)+(1/0.05*(t-k)-0.6/0.05).*(0.55+k<t & t<=0.6+k)+(0.3*sin(2*pi/0.1*(t-0.25-k))).*(0.25+k<t & t<=0.3+k)+(0.2*sin(2*pi/0.2*(t-0.65-k))).*(0.65+k<t & t<=0.75+k);
	else
		y = (1/0.05*(t-k)-0.4/0.05).*(0.40+k<t & t<=0.45+k)+(-2/0.1*(t-k)+0.5/0.05).*(0.45+k<t & t<=0.55+k)+(1/0.05*(t-k)-0.6/0.05).*(0.55+k<t & t<=0.6+k)+(0.3*sin(2*pi/0.1*(t-0.25-k))).*(0.25+k<t & t<=0.3+k)+(2).*(0.7+k<t & t<=0.75+k);;
end